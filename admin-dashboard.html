<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard - JT Chauffeur Services</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/x-icon" href="favicon/favicon.ico" />
    <style>
      body {
        background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
        min-height: 100vh;
      }

      /* Mobile-optimized table - hide on mobile, show cards instead */
      @media (max-width: 768px) {
        .desktop-table {
          display: none;
        }

        .mobile-cards {
          display: block;
        }

        .header-grid {
          grid-template-columns: 1fr !important;
          gap: 1rem;
        }

        .logo-mobile {
          order: -1;
          text-align: center;
        }

        .actions-mobile {
          justify-content: center !important;
          flex-wrap: wrap;
        }
      }

      @media (min-width: 769px) {
        .desktop-table {
          display: table;
        }

        .mobile-cards {
          display: none;
        }
      }

      /* Better touch targets for mobile */
      @media (max-width: 768px) {
        button,
        a,
        select,
        input {
          min-height: 44px;
        }

        .stat-card {
          padding: 1rem !important;
        }

        .stat-value {
          font-size: 1.5rem !important;
        }
      }

      /* Mobile card styling */
      .enquiry-card {
        background: #1f2937;
        border: 1px solid #374151;
        border-radius: 0.5rem;
        padding: 1rem;
        margin-bottom: 1rem;
      }

      .enquiry-card-header {
        display: flex;
        justify-content: space-between;
        align-items: start;
        margin-bottom: 0.75rem;
        padding-bottom: 0.75rem;
        border-bottom: 1px solid #374151;
      }

      .enquiry-card-body {
        font-size: 0.875rem;
        color: #9ca3af;
      }

      .enquiry-card-row {
        display: flex;
        justify-content: space-between;
        padding: 0.5rem 0;
        border-bottom: 1px solid #2d3748;
      }

      .enquiry-card-row:last-child {
        border-bottom: none;
      }

      .enquiry-card-label {
        font-weight: 600;
        color: #d1d5db;
      }

      .enquiry-card-actions {
        display: flex;
        gap: 0.5rem;
        margin-top: 1rem;
        flex-wrap: wrap;
      }

      .enquiry-card-actions button {
        flex: 1;
        min-width: 120px;
        font-size: 0.875rem;
        padding: 0.5rem 1rem;
      }

      /* Status badges */
      .status-badge {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        font-size: 0.75rem;
        font-weight: 600;
      }

      .status-pending_quote {
        background-color: #3b82f6;
        color: white;
      }

      .status-quoted {
        background-color: #8b5cf6;
        color: white;
      }

      .status-confirmed {
        background-color: #10b981;
        color: white;
      }

      .status-cancelled {
        background-color: #ef4444;
        color: white;
      }

      /* Smooth transitions */
      .transition-all {
        transition: all 0.3s ease;
      }

      /* Dropdown positioning fix for mobile */
      @media (max-width: 768px) {
        #docsDropdown {
          right: 0;
          left: auto;
          width: 90vw;
          max-width: 300px;
        }
      }

      /* Sort indicator */
      .sort-indicator {
        opacity: 0.5;
        font-size: 0.75rem;
      }

      th[data-sort]:hover .sort-indicator {
        opacity: 1;
      }

      /* Filter button active state */
      .filter-btn {
        position: relative;
      }
    </style>
  </head>
  <body class="text-white">
    <!-- Header -->
    <header class="bg-gray-900 border-b border-gray-800 sticky top-0 z-50">
      <div class="w-full max-w-full px-4 sm:px-4 lg:px-6 py-3 sm:py-4">
        <div class="grid header-grid grid-cols-1 sm:grid-cols-3 items-center gap-3">
          <!-- Logo - Shows first on mobile -->
          <div class="logo-mobile flex justify-center sm:order-2">
            <img src="images/JTNlogo.png" alt="JT Chauffeur" class="h-12 sm:h-16 w-auto" />
          </div>

          <!-- Left - Admin Info -->
          <div class="text-center sm:text-left sm:order-1">
            <h1 class="text-lg sm:text-xl font-serif text-yellow-500">Admin Dashboard</h1>
            <p class="text-xs sm:text-sm text-gray-400" id="adminName">Loading...</p>
          </div>

          <!-- Right - Actions -->
          <div class="flex actions-mobile justify-center sm:justify-end gap-2 sm:gap-3 sm:order-3">
            <!-- Documentation Dropdown -->
            <div class="relative">
              <button
                id="docsBtn"
                type="button"
                class="bg-gradient-to-r from-yellow-600 to-yellow-500 hover:from-yellow-500 hover:to-yellow-400 text-black px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-bold transition-all shadow-lg hover:shadow-yellow-500/50 flex items-center gap-1 sm:gap-2"
              >
                üìö <span class="hidden sm:inline">Documentation</span
                ><span class="sm:hidden">Docs</span>
                <svg
                  class="w-3 h-3 sm:w-4 sm:h-4"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M19 9l-7 7-7-7"
                  ></path>
                </svg>
              </button>
              <div
                id="docsDropdown"
                class="hidden absolute right-0 mt-2 w-64 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-50"
              >
                <div class="py-2">
                  <a
                    href="docs/index.html"
                    class="block px-4 py-2 hover:bg-gray-700 transition-colors"
                    >üìñ Documentation Home</a
                  >
                  <a
                    href="docs/environment-variables.html"
                    class="block px-4 py-2 hover:bg-gray-700 transition-colors"
                    >‚öôÔ∏è Environment Variables</a
                  >
                  <a
                    href="docs/quote-system.html"
                    class="block px-4 py-2 hover:bg-gray-700 transition-colors"
                    >üí∞ Quote System</a
                  >
                  <a
                    href="docs/api-reference.html"
                    class="block px-4 py-2 hover:bg-gray-700 transition-colors"
                    >üîå API Reference</a
                  >
                  <a
                    href="docs/deployment-guide.html"
                    class="block px-4 py-2 hover:bg-gray-700 transition-colors"
                    >üöÄ Deployment Guide</a
                  >
                  <div class="border-t border-gray-700 my-2"></div>
                  <div class="px-4 py-1 text-xs text-gray-500 font-semibold">AUTO-QUOTE SYSTEM</div>
                  <a
                    href="docs/README_AUTO_QUOTE.md"
                    target="_blank"
                    class="block px-4 py-2 hover:bg-gray-700 transition-colors"
                    >ü§ñ Auto-Quote Overview</a
                  >
                  <a
                    href="docs/QUICK_START_AUTO_QUOTE.md"
                    target="_blank"
                    class="block px-4 py-2 hover:bg-gray-700 transition-colors"
                    >‚ö° Quick Start Guide</a
                  >
                  <a
                    href="docs/AUTO_QUOTE_MODE_GUIDE.md"
                    target="_blank"
                    class="block px-4 py-2 hover:bg-gray-700 transition-colors"
                    >üìö Complete Guide</a
                  >
                  <a
                    href="docs/AUTO_QUOTE_IMPLEMENTATION_SUMMARY.md"
                    target="_blank"
                    class="block px-4 py-2 hover:bg-gray-700 transition-colors"
                    >üîß Technical Details</a
                  >
                </div>
              </div>
            </div>

            <!-- Settings Button -->
            <a
              href="admin-settings.html"
              class="bg-gray-700 hover:bg-gray-600 px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-semibold transition-colors flex items-center space-x-2"
            >
              <i class="fas fa-cog"></i>
              <span class="hidden sm:inline">Settings</span>
            </a>

            <!-- Logout Button -->
            <button
              id="logoutBtn"
              type="button"
              class="bg-red-600 hover:bg-red-700 px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-semibold transition-colors"
            >
              Logout
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="w-full max-w-full px-3 sm:px-4 lg:px-6 py-4 sm:py-8">
      <!-- Stats Cards -->
      <div class="grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-6 mb-4 sm:mb-8">
        <div class="bg-gray-900 rounded-lg p-4 sm:p-6 border border-gray-800 stat-card">
          <div class="text-gray-400 text-xs sm:text-sm mb-1 sm:mb-2">Total</div>
          <div
            class="text-2xl sm:text-3xl font-bold text-yellow-500 stat-value"
            id="totalEnquiries"
          >
            0
          </div>
        </div>
        <div class="bg-gray-900 rounded-lg p-4 sm:p-6 border border-gray-800 stat-card">
          <div class="text-gray-400 text-xs sm:text-sm mb-1 sm:mb-2">Pending</div>
          <div class="text-2xl sm:text-3xl font-bold text-blue-500 stat-value" id="pendingQuotes">
            0
          </div>
        </div>
        <div class="bg-gray-900 rounded-lg p-4 sm:p-6 border border-gray-800 stat-card">
          <div class="text-gray-400 text-xs sm:text-sm mb-1 sm:mb-2">Quoted</div>
          <div class="text-2xl sm:text-3xl font-bold text-purple-500 stat-value" id="quotedCount">
            0
          </div>
        </div>
        <div class="bg-gray-900 rounded-lg p-4 sm:p-6 border border-gray-800 stat-card">
          <div class="text-gray-400 text-xs sm:text-sm mb-1 sm:mb-2">Confirmed</div>
          <div class="text-2xl sm:text-3xl font-bold text-green-500 stat-value" id="confirmedCount">
            0
          </div>
        </div>
      </div>

      <!-- Search and Filters -->
      <div class="bg-gray-900 rounded-lg p-4 sm:p-6 border border-gray-800 mb-4 sm:mb-6">
        <!-- Search Bar -->
        <div class="mb-4">
          <div class="relative">
            <input
              type="text"
              id="searchInput"
              placeholder="Search by reference, customer name, phone, email..."
              class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 pl-10 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent"
            />
            <svg
              class="absolute left-3 top-3.5 h-5 w-5 text-gray-500"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
              ></path>
            </svg>
          </div>
        </div>

        <!-- Filter Buttons -->
        <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
          <button
            id="filterAll"
            type="button"
            class="filter-btn bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg font-semibold transition-colors text-sm"
          >
            All
          </button>
          <button
            id="filterPendingQuote"
            type="button"
            class="filter-btn bg-gray-700 hover:bg-blue-600 px-4 py-2 rounded-lg font-semibold transition-colors text-sm"
          >
            üìã Pending
          </button>
          <button
            id="filterQuoted"
            type="button"
            class="filter-btn bg-gray-700 hover:bg-purple-600 px-4 py-2 rounded-lg font-semibold transition-colors text-sm"
          >
            üí∞ Quoted
          </button>
          <button
            id="filterConfirmed"
            type="button"
            class="filter-btn bg-gray-700 hover:bg-green-600 px-4 py-2 rounded-lg font-semibold transition-colors text-sm"
          >
            ‚úÖ Confirmed
          </button>
        </div>

        <!-- Sort Options -->
        <div class="mt-4 flex flex-col sm:flex-row gap-3">
          <select
            id="sortBy"
            class="bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-yellow-500"
          >
            <option value="date-desc">Newest First</option>
            <option value="date-asc">Oldest First</option>
            <option value="customer-asc">Customer A-Z</option>
            <option value="customer-desc">Customer Z-A</option>
            <option value="price-desc">Price High-Low</option>
            <option value="price-asc">Price Low-High</option>
          </select>
          <button
            id="refreshBtn"
            type="button"
            class="bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded-lg font-semibold transition-colors text-sm flex items-center justify-center gap-2"
          >
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
              ></path>
            </svg>
            Refresh
          </button>
        </div>
      </div>
      <!-- Desktop Table View -->
      <div class="desktop-table bg-gray-900 rounded-lg border border-gray-800 overflow-hidden">
        <div class="overflow-x-auto">
          <table class="w-full table-auto">
            <thead class="bg-gray-800 border-b border-gray-700">
              <tr>
                <th
                  class="px-4 py-4 text-left text-sm font-semibold text-gray-300 cursor-pointer hover:bg-gray-700 transition-colors"
                  data-sort="ref"
                >
                  Ref <span class="sort-indicator">‚Üï</span>
                </th>
                <th
                  class="px-4 py-4 text-left text-sm font-semibold text-gray-300 cursor-pointer hover:bg-gray-700 transition-colors"
                  data-sort="customer"
                >
                  Customer <span class="sort-indicator">‚Üï</span>
                </th>
                <th class="px-4 py-4 text-left text-sm font-semibold text-gray-300">Journey</th>
                <th
                  class="px-4 py-4 text-left text-sm font-semibold text-gray-300 cursor-pointer hover:bg-gray-700 transition-colors"
                  data-sort="date"
                >
                  Date/Time <span class="sort-indicator">‚Üï</span>
                </th>
                <th class="px-4 py-4 text-left text-sm font-semibold text-gray-300">
                  ü§ñ AI Estimate
                </th>
                <th
                  class="px-4 py-4 text-left text-sm font-semibold text-gray-300 cursor-pointer hover:bg-gray-700 transition-colors"
                  data-sort="status"
                >
                  Status <span class="sort-indicator">‚Üï</span>
                </th>
                <th class="px-4 py-4 text-left text-sm font-semibold text-gray-300">Source</th>
                <th class="px-4 py-4 text-left text-sm font-semibold text-gray-300">Actions</th>
              </tr>
            </thead>
            <tbody id="enquiriesTableBody" class="divide-y divide-gray-800">
              <tr>
                <td colspan="8" class="px-6 py-12 text-center text-gray-500">
                  <div class="animate-pulse">Loading enquiries...</div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Mobile Cards View -->
      <div class="mobile-cards" id="enquiriesCardsContainer">
        <div class="text-center py-12 text-gray-500">
          <div class="animate-pulse">Loading enquiries...</div>
        </div>
      </div>

      <!-- Pagination -->
      <div class="mt-4 sm:mt-6 flex flex-col sm:flex-row justify-between items-center gap-3">
        <div class="text-xs sm:text-sm text-gray-400" id="paginationInfo">
          Showing 0 of 0 enquiries
        </div>
        <div class="flex space-x-2">
          <button
            type="button"
            id="prevBtn"
            class="bg-gray-800 hover:bg-gray-700 px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"
          >
            Previous
          </button>
          <button
            type="button"
            id="nextBtn"
            class="bg-gray-800 hover:bg-gray-700 px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"
          >
            Next
          </button>
        </div>
      </div>
    </main>

    <!-- Quote Submission Modal -->
    <div
      id="quoteModal"
      class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4"
    >
      <div
        class="bg-gray-900 rounded-lg p-6 sm:p-8 max-w-md w-full border border-gray-800 max-h-[90vh] overflow-y-auto"
      >
        <h2 class="text-xl sm:text-2xl font-bold text-yellow-500 mb-4 sm:mb-6">Submit Quote</h2>
        <div id="quoteEnquiryDetails" class="mb-4 sm:mb-6 text-xs sm:text-sm text-gray-400"></div>
        <form id="quoteForm" class="space-y-3 sm:space-y-4">
          <div>
            <label class="block text-xs sm:text-sm font-medium text-gray-300 mb-2">Price (¬£)</label>
            <input
              type="number"
              id="quotePrice"
              step="0.01"
              min="0"
              required
              class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 sm:px-4 py-2 text-white text-sm"
              placeholder="150.00"
            />
          </div>
          <div>
            <label class="block text-xs sm:text-sm font-medium text-gray-300 mb-2"
              >Breakdown (Optional)</label
            >
            <textarea
              id="quoteBreakdown"
              rows="3"
              class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 sm:px-4 py-2 text-white text-sm"
              placeholder="Base fare: ¬£100&#10;Airport fee: ¬£30&#10;Waiting time: ¬£20"
            ></textarea>
          </div>
          <div>
            <label class="block text-xs sm:text-sm font-medium text-gray-300 mb-2"
              >Notes (Optional)</label
            >
            <textarea
              id="quoteNotes"
              rows="2"
              class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 sm:px-4 py-2 text-white text-sm"
              placeholder="Additional information for the customer"
            ></textarea>
          </div>
          <div>
            <label class="block text-xs sm:text-sm font-medium text-gray-300 mb-2"
              >Valid Until</label
            >
            <input
              type="datetime-local"
              id="quoteValidUntil"
              class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 sm:px-4 py-2 text-white text-sm"
            />
            <p class="text-xs text-gray-500 mt-1">Default: 48 hours from now</p>
          </div>
          <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 mt-4 sm:mt-6">
            <button
              type="submit"
              class="flex-1 bg-yellow-500 hover:bg-yellow-600 text-black font-semibold py-2 px-4 rounded-lg text-sm"
            >
              Send Quote
            </button>
            <button
              type="button"
              id="cancelQuote"
              class="flex-1 bg-gray-700 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg text-sm"
            >
              Cancel
            </button>
          </div>
        </form>
        <div
          id="quoteError"
          class="hidden mt-4 p-3 bg-red-900 border border-red-700 rounded-lg text-red-200 text-xs sm:text-sm"
        ></div>
        <div
          id="quoteSuccess"
          class="hidden mt-4 p-3 bg-green-900 border border-green-700 rounded-lg text-green-200 text-xs sm:text-sm"
        ></div>
      </div>
    </div>

    <script src="admin.js"></script>
  </body>
</html>
